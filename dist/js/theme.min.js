"use strict";

function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

//
// Custom Scripts
// --------------------------------------------------

/** All sliders function */
document.addEventListener('click', function (e) {
  var isTargetButton = e.target.matches('[data-target]');
  if (!isTargetButton && e.target.closest('[data-active]') != null) return;
  var currentTarget;

  if (isTargetButton) {
    currentTarget = e.target.closest('[data-active]');
    currentTarget.classList.toggle('active');
  }

  document.querySelectorAll('[data-active].active').forEach(function (item) {
    if (item == currentTarget) return;
    item.classList.remove('active');
  });
});

var allSliders = function allSliders() {
  // Detect and add condition classes to slides
  function swiperHomeClassTweak(slidesProp, activeSlide) {
    var slides = slidesProp;
    var activeIndex = activeSlide; // Remove classes

    var _iterator = _createForOfIteratorHelper(slides),
        _step;

    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        var slide = _step.value;
        slide.classList.remove('swiper-slide-prev-n1', 'swiper-slide-prev-n2', 'swiper-slide-next-n1', 'swiper-slide-next-n2');
      } // Get an array of slides indexes. We need an array [0, 1, 2, 3, ..., n]
      // .keys() method return an ArrayIterator, so we have to use a loop

    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }

    var slideKeys = [];

    var _iterator2 = _createForOfIteratorHelper(slides.keys()),
        _step2;

    try {
      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
        var key = _step2.value;
        slideKeys.push(key);
      } // Define active slide index
      // In our test this should be equal to element [8 => 'slide8']

    } catch (err) {
      _iterator2.e(err);
    } finally {
      _iterator2.f();
    }

    var activeSlideIndex = activeIndex; // Compute the indexes of three slides before the active one
    // In out test it should be [5, 6, 7]
    // How it works:
    // 1. get an array slice from the beginning of an array till the activeSlideIndex. .slice() returns a copy of an array
    // 2. get last n elements of sliced array

    var prevSlidesIndexes = slideKeys.slice(0, activeSlideIndex).slice(-3);
    slides[prevSlidesIndexes[1]].classList.add('swiper-slide-prev-n1');
    slides[prevSlidesIndexes[0]].classList.add('swiper-slide-prev-n2'); // Same for slides after the active one. Result should be [9, 10, 11]
    // With on exception: get sliced elements starting from the activeSlideIndex till the end of an array

    var nextSlidesIndexes = slideKeys.slice(activeSlideIndex + 1, -1).slice(0, 3);
    slides[nextSlidesIndexes[1]].classList.add('swiper-slide-next-n1');
    slides[nextSlidesIndexes[2]].classList.add('swiper-slide-next-n2');
  }
  /** Events slider */


  var swiperEvents = new Swiper(".events-slider", {
    effect: "coverflow",
    slidesPerView: 'auto',
    grabCursor: true,
    speed: 500,
    loop: true,
    loopFillGroupWithBlank: true,
    centeredSlides: true,
    slideToClickedSlide: true,
    preloadImages: false,
    lazy: true,
    navigation: {
      nextEl: ".events-button-next",
      prevEl: ".events-button-prev"
    },
    coverflowEffect: {
      rotate: 0,
      stretch: 0,
      depth: 0,
      modifier: 3,
      slideShadows: false
    }
  });
  /** Mixes slider */

  var swiperMixes = new Swiper(".mixes-slider", {
    grabCursor: true,
    speed: 500,
    preloadImages: false,
    lazy: true,
    navigation: {
      nextEl: ".mixes-button-next",
      prevEl: ".mixes-button-prev"
    },
    breakpoints: {
      320: {
        slidesPerView: 2.1,
        centeredSlides: true,
        spaceBetween: 20,
        slidesPerGroup: 1,
        loop: true
      },
      768: {
        slidesPerView: 3,
        spaceBetween: 20,
        slidesPerGroup: 3
      },
      1024: {
        slidesPerView: 3,
        spaceBetween: 30,
        slidesPerGroup: 3
      },
      1366: {
        slidesPerView: 4,
        spaceBetween: 40,
        slidesPerGroup: 4
      },
      1700: {
        slidesPerView: 'auto',
        spaceBetween: 40,
        // slidesPerGroup: 4,
        centeredSlides: true,
        loop: true
      }
    }
  });
  /** Releases slider */

  var swiper = new Swiper(".releases-slider", {
    effect: "cards",
    grabCursor: true,
    preloadImages: false,
    lazy: true,
    navigation: {
      nextEl: ".releases-button-next",
      prevEl: ".releases-button-prev",
      disabledClass: "swiper-button-disabled"
    }
  });
  /** Popular tracks slider */

  var popularItem = document.querySelectorAll(".popular-slider .popular-item__number");

  for (var i = 0; i < popularItem.length; i++) {
    popularItem[i].index = i;
    popularItem[i].innerHTML = i + 1;
  }

  var swiperPopular = new Swiper(".popular-slider", {
    slidesPerView: 1,
    speed: 500,
    navigation: {
      nextEl: '.circle-button-next.popular-slider__btn',
      prevEl: '.circle-button-prev.popular-slider__btn'
    },
    breakpoints: {
      320: {
        slidesPerView: 1
      },
      575: {
        slidesPerView: 1.8,
        spaceBetween: 70
      },
      768: {
        slidesPerView: 1.8,
        spaceBetween: 70
      },
      1024: {
        slidesPerView: 2.3,
        spaceBetween: 70
      },
      1366: {
        slidesPerView: 2.8
      },
      1700: {
        slidesPerView: 3,
        spaceBetween: 38
      }
    }
  });
  /** Studio slider */

  var swiperStudio = new Swiper(".studio-slider", {
    slidesPerView: 1,
    speed: 500,
    loop: true,
    // preloadImages: false,
    // lazy: true,
    pagination: {
      clickable: true,
      el: ".studio-pagination"
    }
  });
  /** Tiktok slider */

  /** Check for resize */

  function checkForWindowResize() {
    function sliderPaddingHack() {
      var offsetSliders = document.querySelectorAll('.offset-slider');
      offsetSliders.forEach(function (slider) {
        var sliderContent = slider.closest('.offset-slider__content');
        var sliderWidth = sliderContent.offsetWidth;
        var containerWidth = document.querySelector('.container').offsetWidth;
        var sliderOffset = (sliderWidth - containerWidth) / 2; // console.log(sliderWidth);
        // console.log(containerWidth);
        // console.log(sliderOffset);

        sliderContent.style.paddingLeft = sliderOffset + 'px'; // console.log(slider);
      });
    }

    ;

    if (document.querySelector('.projects-slider__btn')) {
      sliderArrowPosition();
    }

    if (document.querySelector('.tiktok-slider__btn')) {
      tiktokSliderBtnPosition();
    }

    if (document.querySelector('.offset-slider')) {
      sliderPaddingHack();
    }
  }

  window.addEventListener('resize', checkForWindowResize);
  var swiperTiktok = new Swiper(".tiktok-slider", {
    slidesPerView: 'auto',
    spaceBetween: 15,
    speed: 500,
    preloadImages: false,
    lazy: true,
    navigation: {
      nextEl: '.circle-button-next.tiktok-slider__btn',
      prevEl: '.circle-button-prev.tiktok-slider__btn'
    },
    breakpoints: {
      575: {
        spaceBetween: 20
      },
      1024: {
        spaceBetween: 30
      } // 1366: {
      // 	spaceBetween: 30,
      // },
      // 1700: {
      // 	spaceBetween: 30,
      // },
      // 1921: {
      // 	spaceBetween: 30,
      // },

    },
    on: {
      init: function init() {
        tiktokSliderBtnPosition();
      }
    }
  });
  /** Projects slider */

  var projectsSlider = new Swiper('.projects-slider', {
    slidesPerView: 'auto',
    spaceBetween: 20,
    grabCursor: true,
    speed: 500,
    navigation: {
      nextEl: '.circle-button-next.projects-slider__btn',
      prevEl: '.circle-button-prev.projects-slider__btn'
    },
    breakpoints: {
      320: {
        spaceBetween: 15
      },
      575: {
        spaceBetween: 20
      },
      768: {
        spaceBetween: 20
      },
      1024: {
        spaceBetween: 30
      },
      1366: {
        spaceBetween: 40
      },
      1700: {
        spaceBetween: 36
      }
    }
  });
  /** Slider circle arrow position */

  function tiktokSliderBtnPosition() {
    var tiktokSliderItem = document.querySelectorAll('.titktok-slider__item');
    tiktokSliderItem.forEach(function (item) {
      var tiktokSliderTitle = document.querySelectorAll('.tiktok-slider__name');
      tiktokSliderTitle.forEach(function (title) {
        item.style.paddingBottom = title.offsetHeight + 'px';
      });
    });
  }

  function sliderArrowPosition() {
    var projectsSLiderImg = document.querySelector('.projects-slider__thumb');
    var projectsSliderArrow = document.querySelector('.projects-slider__nav');
    var projectsSliderArrowHeight = projectsSliderArrow.offsetHeight / 2;
    var projectsSliderImgHeight = projectsSLiderImg.offsetHeight / 2 - projectsSliderArrowHeight;
    projectsSliderArrow.style.top = projectsSliderImgHeight + 'px';
  }

  if (document.querySelector('.projects-slider__btn')) {
    sliderArrowPosition();
  }
};
/** Inner sliders function */


var innerSliders = function innerSliders() {
  /** Blog slider */
  var blogSlider = new Swiper('.blog-latest-slider', {
    slidesPerView: 1.2,
    spaceBetween: 20,
    grabCursor: true,
    speed: 500,
    navigation: {
      nextEl: '.blog-button-next',
      prevEl: '.blog-button-prev'
    },
    breakpoints: {
      320: {
        slidesPerView: 1.15,
        spaceBetween: 20
      },
      575: {
        slidesPerView: 1.5,
        spaceBetween: 20
      },
      768: {
        slidesPerView: 1.8,
        spaceBetween: 22
      },
      1024: {
        slidesPerView: 2.1,
        spaceBetween: 22
      },
      1366: {
        slidesPerView: 2.7,
        spaceBetween: 32
      },
      1700: {
        slidesPerView: 3.2,
        spaceBetween: 36
      } // 1920: {
      // 	slidesPerView: 4.2,
      // 	spaceBetween: 36,
      // }

    }
  });
  /** Projects slider */

  var videosSlider = new Swiper('.video-slider', {
    slidesPerView: 1.2,
    spaceBetween: 20,
    grabCursor: true,
    speed: 500,
    slideToClickedSlide: true,
    slidesPerGroup: 1,
    navigation: {
      nextEl: ".video-button-next",
      prevEl: ".video-button-prev"
    },
    breakpoints: {
      320: {
        slidesPerView: 1.35,
        spaceBetween: 15
      },
      575: {
        slidesPerView: 1.5,
        spaceBetween: 20
      },
      768: {
        slidesPerView: 2.1,
        spaceBetween: 20
      },
      1024: {
        slidesPerView: 2.2,
        spaceBetween: 30
      },
      1366: {
        slidesPerView: 2.7,
        spaceBetween: 40
      },
      1700: {
        slidesPerView: 3.2,
        spaceBetween: 36
      }
    }
  });
  /** Slider padding hack */

  function sliderPaddingHack() {
    var offsetSliders = document.querySelectorAll('.offset-slider');
    offsetSliders.forEach(function (slider) {
      var sliderContent = slider.closest('.offset-slider__content');
      var sliderWidth = sliderContent.offsetWidth;
      var containerWidth = document.querySelector('.container').offsetWidth;
      var sliderOffset = (sliderWidth - containerWidth) / 2; // console.log(sliderWidth);
      // console.log(containerWidth);
      // console.log(sliderOffset);

      sliderContent.style.paddingLeft = sliderOffset + 'px'; // console.log(slider);
    });
  }

  ;
  sliderPaddingHack();
};
/** Lazy images function */


var lazyImages = function lazyImages() {
  var images = Array.from(document.querySelectorAll('img[data-src]'));

  if ('IntersectionObserver' in window) {
    var imageObserver = new IntersectionObserver(function (entries, observer) {
      entries.forEach(function (entry) {
        if (entry.isIntersecting) {
          var image = entry.target;
          var imageSiblingSource = entry.target.previousElementSibling; // console.log(imageSiblingSource);

          if (imageSiblingSource) {
            if (imageSiblingSource.hasAttribute('data-srcset')) {
              imageSiblingSource.srcset = imageSiblingSource.dataset.srcset;
              imageSiblingSource.removeAttribute('data-srcset');
            }
          }

          image.src = image.dataset.src;
          image.removeAttribute('data-src');

          image.onload = function () {
            return image.style.opacity = '1';
          };

          imageObserver.unobserve(image);
        }
      });
    });
    images.forEach(function (img) {
      return imageObserver.observe(img);
    });
  }

  var lazyBackgrounds = [].slice.call(document.querySelectorAll(".lazy-background"));

  if ("IntersectionObserver" in window) {
    var lazyBackgroundObserver = new IntersectionObserver(function (entries, observer) {
      entries.forEach(function (entry) {
        if (entry.isIntersecting) {
          entry.target.classList.add("visible");
          lazyBackgroundObserver.unobserve(entry.target);
        }
      });
    });
    lazyBackgrounds.forEach(function (lazyBackground) {
      lazyBackgroundObserver.observe(lazyBackground);
    });
  }
};
/** Preloader function */


var preloaderFunction = function preloaderFunction() {
  /** Preloader */
  window.addEventListener('DOMContentLoaded', function (event) {
    var preloadHome = document.querySelector('.preloader-home');
    var preloadSite = document.querySelector('.preloader-site');

    if (preloadHome) {
      setTimeout(function () {
        document.body.style.overflow = '';
        document.body.style.paddingRight = '';
        preloadHome.classList.add('loaded');
      }, 0);
    }

    if (preloadSite) {
      setTimeout(function () {
        document.body.style.overflow = '';
        document.body.style.paddingRight = '';
        preloadSite.classList.add('loaded');
      }, 1500);
    }
  });
};
/** Forms function */


var formsFunction = function formsFunction() {
  (function () {
    'use strict';

    var forms = document.querySelectorAll('.needs-validation');
    Array.from(forms).forEach(function (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault();
          event.stopPropagation();
        }

        form.classList.add('was-validated');
      }, false);
    });
  })();

  document.querySelectorAll("textarea").forEach(function (el) {
    el.addEventListener("input", function () {
      var cs = window.getComputedStyle(this); // reset height to allow textarea to shrink again

      this.style.height = "auto"; // when "box-sizing: border-box" we need to add vertical border size to scrollHeight

      this.style.height = this.scrollHeight + parseInt(cs.getPropertyValue("border-top-width")) + parseInt(cs.getPropertyValue("border-bottom-width")) + "px";
    });
  });
  var phoneInputs = document.querySelectorAll('.phone-input');
  phoneInputs.forEach(function (phone) {
    phone.addEventListener('input', function (e) {
      var x = e.target.value.replace(/\D/g, '').match(/(\d{0,3})(\d{0,3})(\d{0,4})/);
      e.target.value = !x[2] ? x[1] : '(' + x[1] + ') ' + x[2] + (x[3] ? '-' + x[3] : '');
    });
  });
  document.addEventListener('DOMContentLoaded', function () {
    var rangeInputs = document.querySelectorAll('input[type="range"]');

    function handleInputChange(e) {
      var target = e.target;

      if (e.target.type !== 'range') {
        target = document.getElementById('range');
      }

      var min = target.min;
      var max = target.max;
      var val = target.value;
      target.style.backgroundSize = (val - min) * 100 / (max - min) + '% 100%';
    }

    rangeInputs.forEach(function (input) {
      input.addEventListener('input', handleInputChange);
    });
  });
};
/** Core function */


var coreFunctions = function coreFunctions() {
  /* Check if webp available */
  function testWebP(callback) {
    var webP = new Image();

    webP.onload = webP.onerror = function () {
      callback(webP.height == 2);
    };

    webP.src = "data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";
  } // Добавление класса _webp или _no-webp для HTML


  testWebP(function (support) {
    var className = support === true ? 'webp' : 'no-webp';
    document.documentElement.classList.add(className);
  });
  /* Sticky header  */

  window.addEventListener('scroll', function () {
    var header = document.querySelector('.site-header');
    header.classList.toggle("sticky", window.scrollY > 50);
  });
  /** Menu toggle */

  var menuToggle = document.querySelector('.header-menu__toggle');

  if (menuToggle) {
    var menuInner = document.querySelector('.header-inner');
    menuToggle.addEventListener('click', function () {
      document.documentElement.classList.toggle('overflow-hidden');
      menuToggle.classList.toggle('active');
      menuInner.classList.toggle('active');
    });
  }
  /** Decorations parallax */


  var rellax = new Rellax('.rellax');
};

coreFunctions();
allSliders();
innerSliders();
lazyImages();
preloaderFunction();
formsFunction();